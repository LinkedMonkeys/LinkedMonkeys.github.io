<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>Inventory app -- demo of state hoisting</h1>

    <p>The goal is to build an app for counting inventory.</p>
    <img src="sample-ui.png" alt="The UI of the inventory app">
    <p>If the entire activity's UI is in a single function, there is no need to hoist state.  Writing a function for the Row of buttons makes it easier to write, removes repeated code, and would be expandable to include any number of button Rows.</p>

    <div class="options">
    <div class="example">
    <h2>Initial version (total does not update)</h2>
    <pre>
@Composable
fun InventoryScreen(modifier: Modifier = Modifier) {
    var totalItems by remember { mutableStateOf(0) }










    
    Column(
        modifier = modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
<span class="remove">        ButtonRow("A:")
        ButtonRow("B:")</span>
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(10.dp),
            horizontalArrangement = Arrangement.End
        ) {
            Text(
                text = "Total items: $totalItems",
                fontWeight = androidx.compose.ui.text.font.FontWeight.Bold,
            )
        }
    }
}

@Composable
private fun ButtonRow(
    modifier: Modifier = Modifier,
    heading: String,
    ) {
<span class="remove">    var count by remember { mutableStateOf(0) }</span>
        
    Row(
        verticalAlignment = Alignment.CenterVertically
    ) {
        Text(
            modifier = Modifier.padding(10.dp),
            text = heading
        )
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { count++ },
        ) {
            Text("+1")
        }
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { count += 10 },
        ) {
            Text("+10")
        }
        Text(
            modifier = Modifier.padding(10.dp),
            text = "$count"
        )
    }
}
    </pre>
</div>

<div class="example">
<h2>Completed version (after hoisting state)</h2>
<pre>
@Composable
fun InventoryScreen(modifier: Modifier = Modifier) {
    var totalItems by remember { mutableStateOf(0) }
<span class="add">    var countA by remember { mutableStateOf(0) }
    var countB by remember { mutableStateOf(0) }
    val updateA: (Int) -&gt; Unit = {
        countA += it
        totalItems += it
    }
    val updateB: (Int) -&gt; Unit = {
        countB += it
        totalItems += it
    }</span>

    Column(
        modifier = modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
<span class="add">        ButtonRow(heading = "A:", count = countA, update = updateA)
        ButtonRow(heading = "B:", count = countB, update = updateB)</span>
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(10.dp),
            horizontalArrangement = Arrangement.End
        ) {
            Text(
                text = "Total items: $totalItems",
                fontWeight = androidx.compose.ui.text.font.FontWeight.Bold,
            )
        }
    }
}

@Composable
private fun ButtonRow(
    modifier: Modifier = Modifier,
    heading: String,
<span class="add">    count: Int,
    update: (Int) -&gt; Unit,</span>
    ) {
    Row(
        verticalAlignment = Alignment.CenterVertically
    ) {
        Text(
            modifier = Modifier.padding(10.dp),
            text = heading
        )
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
<span class="add">            onClick = { update(1) },</span>
        ) {
            Text("+1")
        }
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
<span class="add">            onClick = { update(10) },</span>
        ) {
            Text("+10")
        }
        Text(
            modifier = Modifier.padding(10.dp),
            text = "$count"
        )
    }
}
</pre>
</div>
</div>


<hr>
<h2>Modifying to allow an array of ButtonRows</h2>

<p>Once we have the state hoisted, it is not to hard to generalize to allow for an arbitrary number of ButtonRows.  The strangest part is how the counter List must be declared.</p>
    <div class="options">
<div class="example">
<h2>Completed version (after hoisting state)</h2>
<pre>
@Composable
fun InventoryScreen(modifier: Modifier = Modifier) {
    var totalItems by remember { mutableStateOf(0) }
<span class="remove">    var countA by remember { mutableStateOf(0) }
    var countB by remember { mutableStateOf(0) }
    val updateA: (Int) -&gt; Unit = {
        countA += it
        totalItems += it
    }
    val updateB: (Int) -&gt; Unit = {
        countB += it
        totalItems += it
    }</span>

    Column(
        modifier = modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
<span class="remove">        ButtonRow(heading = "A:", count = countA, update = updateA)
        ButtonRow(heading = "B:", count = countB, update = updateB)</span>
        
        
        
        
        
        
        
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(10.dp),
            horizontalArrangement = Arrangement.End
        ) {
            Text(
                text = "Total items: $totalItems",
                fontWeight = androidx.compose.ui.text.font.FontWeight.Bold,
            )
        }
    }
}

@Composable
private fun ButtonRow(
    modifier: Modifier = Modifier,
    heading: String,
    count: Int,
    update: (Int) -&gt; Unit,
    ) {
    Row(
        verticalAlignment = Alignment.CenterVertically
    ) {
        Text(
            modifier = Modifier.padding(10.dp),
            text = heading
        )
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { update(1) },
        ) {
            Text("+1")
        }
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { update(10) },
        ) {
            Text("+10")
        }
        Text(
            modifier = Modifier.padding(10.dp),
            text = "$count"
        )
    }
}
</pre>
</div>
    <div class="example">
    <h2>Array version</h2>
    <pre>
@Composable
fun InventoryScreen(modifier: Modifier = Modifier) {
    var totalItems by remember { mutableStateOf(0) }
<span class="add">    val numRows = 10
    // Not sure why we do not use the "by" keyword.
//    var counts by remember { mutableStateListOf&lt;Int&gt;() }
    var counts = remember { mutableStateListOf&lt;Int&gt;() }

    // Create the counters in the list.
    for (i in 0 until numRows) {
        counts.add(0)
    }</span>

    Column(
        modifier = modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
<span class="add">        for (i in 0 until numRows) {
            ButtonRow(
                heading = "${'A'+i}",
                count = counts[i],
                update = {
                    counts[i] += it
                    totalItems += it
                }
            )
        }</span>
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(10.dp),
            horizontalArrangement = Arrangement.End
        ) {
            Text(
                text = "Total items: $totalItems",
                fontWeight = androidx.compose.ui.text.font.FontWeight.Bold,
            )
        }
    }
}

@Composable
private fun ButtonRow(
    modifier: Modifier = Modifier,
    heading: String,
    count: Int,
    update: (Int) -&gt; Unit,
) {
    Row(
        verticalAlignment = Alignment.CenterVertically
    ) {
        Text(
            modifier = Modifier.padding(10.dp),
            text = "$heading:",
        )
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { update(1) },
        ) {
            Text("+1")
        }
        Button(
            modifier = Modifier
                .padding(10.dp)
                .width(100.dp),
            onClick = { update(10) },
        ) {
            Text("+10")
        }
        Text(
            modifier = Modifier.padding(10.dp),
            text = "$count"
        )
    }
}
    </pre>
    </div>
</div>

</body>
</html>